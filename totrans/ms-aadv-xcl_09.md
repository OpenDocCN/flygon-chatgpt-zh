# [第8章小计和数据合并](contents.xhtml#ch08a)

[介绍](contents.xhtml#sc2_94a)

有时，我们需要在报告末尾计算小计，然后是总计。通常，我们通过使用SUM函数在每个组的末尾添加一行来执行此操作。尽管这不是做小计的错误方式，但手动干预的数量最大化了错误的可能性。

Excel提供了一种有效的方法来使用子总计功能完成这项工作。该章节将以数据合并结束。

[结构](contents.xhtml#sc2_95a)

在本章中，我们将讨论以下主题：

+   子总计

+   合并数据

[目标](contents.xhtml#sc2_96a)

在学习本章后，读者将能够定义小计，学习如何使用小计创建数据的单层和多层摘要，以及识别各种类型的函数。

[子总计](contents.xhtml#sc2_97a)

我们有Excel的子总计功能，可以帮助我们自动计算列表中的小计和总计值。

根据我们所拥有的报告类型，我们需要执行以下两种工作：

+   单层子总计

+   多层子总计

[显示单层子总计](contents.xhtml#sc3_98a)

在对数据进行子总计之前，我们首先需要根据需要进行小计的字段对列表进行排序。假设我们想要在列表中按地区计算小计，同时还需要根据地区列对数据进行排序。要找到子总计，请按照以下步骤操作：

1.  从数据选项卡 | 大纲组中单击子总计命令。

1.  出现一个子总计对话框，如[图8.1](#fig8-1)所示：

    ![](images/Figure_8.1.png)

    图8.1：子总计

1.  从“在每次更改时”列表框中选择所需的列。

1.  从“使用函数”列表框中选择要对数据执行的函数。

1.  从“添加小计到：”字段中选择要执行小计的列。

单击“确定”按钮后，Excel会为所选列中相同项目组插入一个小计行。子总计对话框中还有一些其他选项，如[图8.1](#fig8-1)所示。具体解释如下：

+   选择摘要函数：第一次为列表使用子总计命令时，Excel会根据您在“添加小计到”框中选择的列中的数据类型建议一个摘要函数。通过在子总计对话框中的“使用函数”框中选择不同的摘要函数，如平均值，选择不同的计算。

+   选择要总结的值：第一次使用子总计命令时，“添加小计到”框显示最右列的标签。您可以保留所选的标签，也可以选择列表中任何其他列的标签。下次使用子总计命令时，Excel会显示您上次选择的最后一列的标签。

+   显示详细数据上方的小计行：如果希望小计行显示在其相关详细数据的上方，并且总计行显示在列表顶部，请清除“数据下方摘要”复选框。

[显示嵌套小计](contents.xhtml#sc3_99a)

有时，您需要对数据执行多层小计。例如，您需要按区域和部门对数据进行分组。在这种情况下，请按照以下步骤操作：

1.  首先，如前所述，您需要按区域和部门对数据进行排序。

1.  从数据选项卡 | 大纲组中点击“小计”命令。

1.  从“在每次更改时”列表框中选择“区域”列。

1.  从“使用函数”列表框中选择要对数据执行的函数。

1.  从“添加小计到”字段中选择要执行小计的列。

1.  单击“确定”按钮，执行第一层小计。

1.  再次选择“小计”命令，并从“在每次更改时”列表框中选择“部门”列。

1.  从“使用函数”列表框中选择要对数据执行的函数。

1.  从“添加小计到”字段中选择要执行小计的列。

1.  在单击“确定”按钮之前，清除“替换当前小计”的复选框，如[图 8.2](#fig8-2)所示。

    ![](images/Figure_8.2.png)

    图 8.2：用于嵌套小计的子总对话框

注意：如果您只想复制摘要详细信息，请选择摘要所在的大纲。选择所需的列，按下Alt键（选择仅可见单元格），然后复制并粘贴。

[合并数据](contents.xhtml#sc2_100a)

在Excel中合并数据可以将来自多个范围或工作表的数据合并为单个摘要报告。以下是在Excel中合并数据的逐步指南：

1.  打开一个新的工作表，您想要合并数据的地方，如[图 8.3](#fig8-3)所示：

    ![](images/Figure_8.3.png)

    图 8.3：打开一个新的工作表

1.  选择要放置合并数据的单元格，如[图 8.4](#fig8-4)所示：

    ![](images/Figure_8.4.png)

    图 8.4：选择单元格

1.  单击顶部菜单栏中的“数据”选项卡，然后单击“数据工具”组中的“合并”按钮，如[图 8.5](#fig8-5)所示：

    ![](images/Figure_8.5.png)

    图 8.5：合并选项

1.  在合并对话框中，选择要用于合并的函数，例如SUM、AVERAGE、COUNT等，如[图 8.6](#fig8-6)所示：

    ![](images/Figure_8.6.png)

    图 8.6：合并对话框

1.  通过单击“引用”字段旁边的“折叠对话框”按钮并选择要合并的单元格来选择要合并的单元格范围。参考[图 8.7](#fig8-7)：

    ![](images/Figure_8.7.png)

    图 8.7：选择要合并的单元格

1.  如果您想 consolide 来自多个工作表的数据，请单击“所有引用”字段中的“添加”按钮，然后选择要 consolide 的附加工作表和单元格范围。参考 [图 8.8](#fig8-8)：

    ![](images/Figure_8.8.png)

    图 8.8：从多个工作表 consolide 数据

1.  对于要包含在 consolide 中的任何其他工作表，请重复上一步骤。

1.  确保如果您不想在 consolide 中包括这些项目，则取消选中“顶部行”和“左列”复选框，如 [图 8.9](#fig8-9) 所示：

    ![](images/Figure_8.9.png)

    图 8.9：标签使用复选框

1.  单击“确定”以 consolide 数据，如 [图 8.10](#fig8-10) 所示：

    ![](images/Figure_8.10.png)

    图 8.10：单击“确定”

在您 consolide 数据之后，结果将显示在您在第二步中选择的单元格中。您还可以使用 consolide 功能创建数据透视表，这可以提供有关数据的更详细摘要。

[consolide 数据示例](contents.xhtml#sc3_101a)

假设您有三个工作表，每个工作表包含不同地区（东部、西部和南部）的销售数据。每个工作表具有相同的格式，包括产品、销售代表和销售金额列，如 [图 8.11](#fig8-11) 所示：

![](images/Figure_8.11.png)

图 8.11：示例工作表

要将这些工作表中的数据 consolide 到单个摘要报告中，请按照给定的步骤进行：

1.  打开一个新的工作表，您想在其中 consolide 数据，就像我们在 [图 8.3](#fig8-3) 中所做的那样。

1.  选择要放置 consolide 数据的单元格，例如，如 [图 8.12](#fig8-12) 所示的单元格 A1：

    ![](images/Figure_8.12.png)

    图 8.12：选择一个单元格

1.  单击顶部菜单栏中的“数据”选项卡，然后单击“数据工具”组中的“consolide”按钮，就像 [图 8.5](#fig8-5) 中所示的那样。

1.  在 consolide 对话框中，选择要用于 consolide 的函数（例如，SUM、AVERAGE、COUNT 等），就像 [图 8.6](#fig8-6) 中所做的那样。

1.  通过单击“引用”字段旁边的“折叠对话框”按钮选择要 consolide 的单元格范围，然后在东工作表上选择要 consolide 的单元格，例如 A1:C10，如 [图 8.13](#fig8-13) 所示：

    ![](images/Figure_8.13.png)

    图 8.13：选择要 consolide 的单元格

1.  如果您想 consolide 来自多个工作表的数据，请单击“所有引用”字段中的“添加”按钮，然后选择要 consolide 的附加工作表和单元格范围（例如，在西工作表上选择范围，然后在南工作表上选择范围），如 [图 8.14](#fig8-14) 所示：

    ![](images/Figure_8.14.png)

    图 8.14：从多个工作表 consolide 数据

1.  确保如果您不想在 consolide 中包括这些项目，则取消选中“顶部行”和“左列”复选框，如 [图 8.9](#fig8-9) 所示。

1.  点击“确定”以合并数据，如[图 8.10](#fig8-10)所示。

最终合并的数据可以在以下[图 8.15](#fig8-15)中看到：

![](images/Figure_8.15.png)

图 8.15: 最终合并的数据

[结论](contents.xhtml#sc2_102a)

总之，本章介绍了 Excel 中小计和数据合并的概念。小计允许在列表中自动计算小计和总计值，使数据分析更加高效。小计功能可用于根据选择的列和函数创建单层和多层数据摘要。

数据合并使得可以将来自多个范围或工作表的数据合并为单个摘要报告。合并功能提供各种合并函数，并允许选择特定单元格或范围进行合并。当处理来自不同来源或工作表的数据时，此功能尤其有用。

通过掌握小计和数据合并，用户可以简化其数据分析过程，并生成准确和全面的报告，减少手动干预。

[练习](contents.xhtml#sc2_103a)

任务 1: 为合并打开一个新工作表。

任务 2: 计算每个区域的小计，并使用小计功能显示它们。

区域：东部

| 产品 | 销售代表 | 销售金额 |
| --- | --- | --- |
| A | John | $500 |
| B | Amy | $700 |
| C | John | $400 |

表 8.1: 东部区域详情

区域：西部

| 产品 | 销售代表 | 销售金额 |
| --- | --- | --- |
| A | Sarah | $600 |
| B | Sarah | $900 |
| C | Jack | $350 |

表 8.2: 西部区域详情

区域：南部

| 产品 | 销售代表 | 销售金额 |
| --- | --- | --- |
| A | Emma | $800 |
| B | Emma | $600 |
| C | David | $450 |

表 8.3: 南区详情

任务 3: 使用合并功能将三个区域的数据合并为单个摘要报告。

任务 4: 回答以下问题：

1.  每个区域的总销售额是多少？

1.  三个区域的总销售额是多少？

加入我们书籍的 Discord 空间

加入书籍的 Discord 工作区，获取最新更新、优惠、全球技术动态、新发布和与作者的交流：

**[https://discord.bpbonline.com](https://discord.bpbonline.com)**

![](images/fm1.png)
