# 第九章

# ChatGPT：使用 ChatGPT 解决查找问题

# 介绍

在本章中，我们将讨论如何将人工智能（AI）融入到解决 Excel 中的查找问题中。

在我们了解外部人工智能之前，我们想要承认一些内置的 AI 功能，如 Flash Fill（使用模式识别）、Power Query 中的按列示例选项（也使用模式识别并编写可重用的 M 代码函数）、数据分析选项（创建图表和分析）、推荐图表（显示您可以从数据创建的各种图表）和推荐数据透视表（显示您可以从数据创建的各种数据透视表分析）。

ChatGPT 代表了由 OpenAI 领先的语言生成领域的尖端发展。它属于 GPT（生成式预训练变换器）模型系列。利用变换器架构，GPT 模型可以理解和生成类似人类语言的文本，借鉴它们所提供的输入。

在使用 ChatGPT 时最关键的技能是提示。提示是您提供的文本，用于开始聊天或要求模型给出特定回应。当您与 ChatGPT 交互时，您会以提示开始对话 —— 一个问题，一个陈述，或任何传达您意图的文本。

您的提示的质量和具体性通常会影响您从 ChatGPT 收到的回应的实用性和相关性。提供清晰和详细的提示可以导致更准确和有用的答案。

# 结构

在本章中，我们将讨论以下五种更好地利用 ChatGPT 的方法：

+   为获得最佳结果设置 ChatGPT

+   掌握完美的 ChatGPT 提示

+   提高 ChatGPT 提示的准确性

+   高级 ChatGPT 使用技巧

+   超越 ChatGPT

# 为获得最佳结果设置 ChatGPT

充分利用 ChatGPT 的第一步是创建自定义说明，这有助于避免在每个提示中重复偏好。

以下是要遵循的步骤：

1.  要访问您的自定义说明设置，请单击您的个人资料，然后单击自定义说明，如*图 9.1*所示：![](img/Figure-9.1.jpg)

    **图 9.1：** 访问自定义说明

1.  告诉 ChatGPT 一些关于你自己的事情。这有助于 ChatGPT 给出更与你的工作/目标/兴趣相关的回应。例如，查看我的示例在*图 9.2*：![](img/Figure-9.2.jpg)

    **图 9.2：** 为 ChatGPT 提供关于你自己的背景

1.  下一步是告诉 ChatGPT 你希望它如何回应。回应是正式/随意的，长/短的，中立/主观的？例如，查看我的示例在*图 9.3*：![](img/Figure-9.3.jpg)

    **图 9.3：** 为 ChatGPT 提供关于您希望回应的指示

1.  保存并关闭，现在您可以开始提示。但在此之前，让我们学习如何创建说明。

**注意**：

+   ChatGPT 以不时提供错误响应而闻名。作为该领域的新手，您可能不会立即注意到这些错误，但您可以通过要求包含置信水平和源 URL 来减少错误响应的可能性。

+   通过可靠来源（URL）交叉参考来验证响应。

参见*图 9.4*，了解在 ChatGPT 中配置置信水平和 URL 设置。

![](img/Figure-9.4.jpg)

**图 9.4：** 要求置信水平和事实 URL

# 掌握完美的 ChatGPT 提示

正如我们在介绍中学到的，您的提示的质量和具体性决定了响应的实用性和相关性。

现在让我们学习构成良好提示的四个基本要素，即任务、背景、示例和角色。

1.  **任务**

    在您的提示中必须有一个任务。这通过以动作动词开始您的提示来表示。

    例如，“生成一个可以使用多个条件获取数据的 Excel 内置查找函数列表。”

    前述提示将列出所有查找函数以及如何使用它进行多条件查找的示例语法。

    前述提示的唯一问题是它只会提供 Excel 中的函数，而不会提供 Power Query，因为这是我们给定的上下文。那么，什么是上下文？

1.  **背景**

    ChatGPT 可以提供无限量的信息，这可能不是您要寻找的。因此，您需要限制无尽的可能性。

    ChatGPT 限制可能性的一种方式是查看我们在上一节设置的自定义说明。

    此外，您需要指示环境作为一个限制因素。

    例如，如果您需要 Power Query 查找函数，则提示将是：“生成一个可以使用多个条件获取数据的 Power Query 查找函数列表。”

    环境可以缩小到特定函数。例如，“生成 Excel 中 FILTER 函数可以使用多个条件获取数据的方法列表。”

    另一种微调上下文的方法是告诉 ChatGPT 用户的背景。例如，“写出新手获取数据使用多个条件的最简单方法”。通过指示用户是新手，ChatGPT 将限制给出的响应。

1.  **示例**

    这些只是 ChatGPT 可以了解所需响应更多信息的示例。在您的提示中包含示例显着提高了结果的准确性。

    例如，如果您希望公式包含加号（+）而不是 OR 函数（正如我们在*第七章，FILTER：终极查找函数*中学到的`**FILTER**`函数），那么提示将是“使用加号而不是 OR 函数编写多条件`**INDEX/MATCH**`函数。”

1.  **角色**

    这是您希望 AI 在执行任务时成为的人物。想想一个在线可访问且 ChatGPT 可以轻松访问的著名人物。人物角色为 ChatGPT 提供了在回应提示时所需的写作风格、领域和专业水平。

    例如，在 Excel 中，人物角色可以是著名的微软 MVP（最有价值的专业人士）。

    这是一个包含人物角色的提示示例：

    编写一个 Power Query 近似查找函数。将其编写为著名的 Excel 专家 Bill Jellen，又名“Mr. Excel”，或 Mike Girvin，又名“Excel is Fun”。

    如*图 9.5*所示，ChatGPT 将确保响应与提供的人物角色的写作风格相关且一致。

    ![](img/Figure-9.5.jpg)

    **图 9.5：** 为 ChatGPT 提供人物角色

**注意**

+   在您的提示中有一个任务是**强制性**的。

+   包含相关背景和示例是**重要**的。

+   拥有一个人物角色是**有益的**。

# 提高 ChatGPT 提示的准确性

正如我们在前一节关于设置 ChatGPT 时学到的，准确性并不保证，这往往会让无法排除响应问题的新手感到沮丧。

除了在响应中请求置信度水平和 URL 之外，让我们探讨四种增加准确性的方法：

1.  **自我批评**

    要求 ChatGPT 批评自己并优化其响应以提高准确性。

    例如，在掌握提示的前一节中，我们要求使用 Bill Jellen 或 Mike Girvin 的风格编写近���查找 M 代码。假设我们对 M 代码还不熟悉，我们希望 ChatGPT 在我们使用代码之前帮助我们解决问题。

    这是一个我们可以询问的后续自我批评问题，如*图 9.6*所示：

    ![](img/Figure-9.6.jpg)

    **图 9.6：** 提出后续自我批评问题

1.  **简洁明了**

    强制 ChatGPT 修改响应并将其限制在特定步骤或单词可以帮助提高其响应准确性。

    在继续研究用于近似查找的 M 代码功能时，我们可以进一步询问减少到三个步骤的步骤，如*图 9.7*所示：

    ![](img/Figure-9.7.jpg)

    **图 9.7：** 限制响应的步骤或单词

    **注意：** 给 ChatGPT 的约束越多，通常响应就会更有创意。尝试每次添加一个约束，并测试你的功能，看看哪个会优化速度和准确性。

1.  **要求 ChatGPT 自我提示**

    让 ChatGPT 发自内心地提示是让其发挥最佳作用的一种方式。这确保了它优化其提示并产生更丰富的响应。

    例如，ChatGPT 如何帮助您掌握 Excel 中的查找功能？（见*图 9.8*）：

    ![](img/Figure-9.8.jpg)

    **图 9.8：** ChatGPT 中的自我提示

    **注意：** 无论您是学生还是培训师，上述自我提示和后续问题都可以帮助您为掌握 Excel 中的任何概念制定有效的策略。

1.  了解 ChatGPT 的局限性

    了解当前的弱点及其解决方法将极大地提高您的回应准确性。

这里列出了一些限制：

+   了解 ChatGPT 可访问版本的知识基于其截至 2021 年 9 月最后更新的训练数据。它可能无法访问实时数据或最新事件。

+   尽管 ChatGPT 已经接受了多样化主题的训练，但它可能不像某个特定领域的专家那样专业。其回应应该通过领域特定的来源进行验证以确保准确性。

+   ChatGPT 遭受“AI 幻觉”的困扰，即生成听起来正确但事实上错误或有偏见的答案的倾向。

+   免费版本仅限于文本。它无法查看、解释或分析图像、图表或非文本数据。

# 高级 ChatGPT 使用的技巧和窍门

正如我们在本章中迄今所学到的——提示是您需要培养的终极技能，以最大限度地利用 ChatGPT。

以下是一些提升技能的有用方法：

1.  每天设定一个学习提示的时间段。从这个免费网站开始：[`learnprompting.org/docs/intro`](https://learnprompting.org/docs/intro)

1.  经常开始应用提示。这可以通过识别频繁的手动任务，然后创建和优化提示以自动化它来完成。例如，如果您每天需要 consololidate data from multiple worksheets，创建一个提示，它将为您生成一个 M 代码，以自动化这个过程。

1.  创建一个有价值的提示数据库，您可以创建或在线找到。根据它们将帮助解决的问题而不是函数来组织提示，以便轻松访问和使用。例如，将提示存储在“如何在查找中返回多个项目”标题下，而不是“INDEX/MATCH 提示”下。

1.  设定一个每日阅读时间，ChatGPT 正在解决真实案例。请参见以下链接中的示例：

    [`blog.enterprisedna.co/chat-gpt-for-excel-a-beginners-guide-with-examples/`](https://blog.enterprisedna.co/chat-gpt-for-excel-a-beginners-guide-with-examples/)

1.  加入一个新闻简报，以便及时了解人工智能领域的最新发展。Big Brains Newsletter 是一个推荐的选择。欲了解更多信息，请访问以下链接：

    [`www.bigbraindaily.com/`](https://www.bigbraindaily.com/)

# 超越 ChatGPT

除了 ChatGPT 之外，还值得一提的是一些 AI 工具以及它们为什么是更好的替代品，如下所示：

1.  Bing Chat ([`www.bing.com/search?q=Bing+AI&showconv=1`](https://www.bing.com/search?q=Bing+AI&showconv=1))

    与 ChatGPT 3.5 的免费版本不同，Bing Chat 的可访问版本提供了一种上传数据截图并要求 AI 分析的方法。

    通过上传的图片，您可以指向 AI 您的数据单元引用以及您希望返回结果的位置。

    ![](img/Figure-9.9.jpg)

    **图 9.9：** 在 Bing 中上传数据截图

1.  AI Excel 机器人 ([`aiexcelbot.com/?anchor=features`](https://aiexcelbot.com/?anchor=features))

    这是一个带有 Excel 工作簿插件的免费服务。

1.  公式机器人 ([`formulabot.com/`](https://formulabot.com/))

    优势在于它具有插件，并且可以上传工作簿以进行更快的分析。它目前的局限性在于它只能���行 Python 代码而不能执行 Excel 函数。

1.  在 Excel 中安装 AI 插件。

    对于我们的情况，我们将安装 AI 辅助公式编辑器。以下是步骤：

    +   转到`**插入**`选项卡，然后点击`**获取插件**`。

    +   搜索`**AI 辅助公式编辑器**`，然后点击`**添加**`。![](img/Figure-9.10.jpg)

        **图 9.10：** 添加 AI 辅助公式编辑器

    +   使用您的 Gmail 登录，您就可以开始使用它了。

    +   您可以升级到高级订阅或使用有限的免费版本来生成公式或解释公式。

# 结论

在本章中，我们探讨了将人工智能，特别是 ChatGPT，整合到 Excel 中以解决查找挑战的方法。了解提示的微妙之处并有效利用 ChatGPT 对于准确和定制的响应至关重要。

本章向我们介绍了 ChatGPT 的能力，强调了精确提示的重要性以产生准确的响应。内置 AI 功能如 Flash Fill 和 Power Query 选项的值得一提，为我们的探索提供了上下文背景。

与 ChatGPT 的旅程并没有结束；这只是一个开始。读者被邀请在 Excel 论坛中分享他们的经验或提出问题。让这成为一个双向对话。请专家分享他们如何将 ChatGPT 应用于 Excel 任务以及他们面临的挑战。他们的见解可以丰富您的学习以及社区中其他人的学习。提出问题，分享您的成功，让我们互相学习。

最后，鼓励读者踏上他们的学习之旅。他们可以探索权威的在线资源，加入论坛，或参加教程会话。ChatGPT 和 Excel 的世界充满活力，不断发展。通过寻求这些页面之外的知识，您可以赋予自己在人工智能驱动的数据解决方案不断变化的领域中航行的能力。

# 需要记住的要点

+   **清晰明确的提示**：使用动作动词和详细说明所需结果，精心制作明确的提示。您的查询的清晰度确保 ChatGPT 提供准确和相关的响应。

+   **提供上下文**：清晰地定义您 Excel 分析的上下文，指定数据类型和任务范围。上下文信息有助于 ChatGPT 根据您特定的数据需求调整其响应。

+   **参与对话**：将 ChatGPT 视为合作伙伴。如果初始响应不准确，请提出后续问题并寻求澄清。迭代对话将引导 ChatGPT 朝着您寻找的精确解决方案前进。

+   **验证和学习**：始终通过与可靠来源交叉参考和在 Excel 中进行额外分析来验证 ChatGPT 的回应。人类监督对于准确性至关重要。将 ChatGPT 的建议视为自己探索和学习的起点。

# 多项选择题

1.  在使用 ChatGPT 进行 Excel 任务时，清晰和具体的提示的重要性是什么？

    1.  清晰的提示增强了 ChatGPT 的词汇量

    1.  具体的提示确保准确和相关的回应

    1.  清晰的提示对于 ChatGPT 在离线状态下运行至关重要

    1.  仅对复杂的 Excel 任务需要具体的提示

1.  为什么在与 ChatGPT 互动进行 Excel 分析时提供上下文至关重要？

    1.  上下文增强了 ChatGPT 的通识知识

    1.  上下文信息帮助 ChatGPT 量身定制回应以满足特定数据需求

    1.  提供上下文可以提高 ChatGPT 的处理速度

    1.  在 Excel 任务中使用 ChatGPT 时上下文是无关紧要的

1.  如果 ChatGPT 的回应不完全符合您的需求，您应该如何处理？

    1.  忽略回应并重新表述同一问题

    1.  将 ChatGPT 的回应视为最终答案

    1.  参与对话，提出后续问题，并寻求澄清

    1.  终止对话并开始新对话

1.  在与 ChatGPT 进行 Excel 数据分析互动中，人类监督扮演什么角色？

    1.  人类监督是不必要的；ChatGPT 总是准确的

    1.  人类监督确保 ChatGPT 的道德行为

    1.  人类监督对于验证 ChatGPT 的回应并确保准确性至关重要

    1.  人类监督仅适用于初学者，而不适用于有经验的用户

1.  以下哪项最好描述了在 Excel 任务中 ChatGPT 与用户之间的关系？

    1.  ChatGPT 是一个独立的解决方案，不需要用户输入

    1.  应接受 ChatGPT 的回应而无需验证

    1.  ChatGPT 和用户进行合作伙伴关系，用户提供清晰提示和监督

    1.  ChatGPT 可以独立处理 Excel 任务；用户输入是可选的

# 答案

1.  b

1.  b

1.  c

1.  c

1.  c
