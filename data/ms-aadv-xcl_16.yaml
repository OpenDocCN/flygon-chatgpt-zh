- en: '[CHAPTER 15Assigning Buttons to Macros](contents.xhtml#ch15a)'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[第15章将按钮分配给宏](contents.xhtml#ch15a)'
- en: '[Introduction](contents.xhtml#sc2_207a)'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '[介绍](contents.xhtml#sc2_207a)'
- en: In this chapter, we will explore the process of assigning buttons to macros
    in Excel. By creating buttons on the Quick Access Toolbar and Excel worksheets,
    we can automate tasks, improve efficiency, and simplify complex operations. Join
    us as we delve into the world of Excel automation and discover the power of button-macro
    integration.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将探讨在Excel中将按钮分配给宏的过程。通过在快速访问工具栏和Excel工作表上创建按钮，我们可以自动化任务，提高效率并简化��杂操作。加入我们，深入探索Excel自动化的世界，并发现按钮-宏集成的力量。
- en: '[Structure](contents.xhtml#sc2_208a)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[结构](contents.xhtml#sc2_208a)'
- en: 'In this chapter, we will go over the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论以下主题：
- en: Creating buttons on Quick Access Toolbar
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在快速访问工具栏上创建按钮
- en: Modifying menus or buttons
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 修改菜单或按钮
- en: Creating a button on Excel worksheet
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Excel工作表上创建按钮
- en: Editing the recorded macros
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编辑记录的宏
- en: '[Objectives](contents.xhtml#sc2_209a)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '[目标](contents.xhtml#sc2_209a)'
- en: By the end of this chapter, the reader will understand how to create buttons
    on the Quick Access Toolbar for quick access to macros, and learn how to modify
    menus or buttons to customize their appearance and functionality. The reader will
    also be able to explore the process of creating buttons directly on Excel worksheets
    for specific tasks, as well as gain proficiency in editing recorded macros to
    enhance automation and tailor them to specific requirements.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 通过本章结束时，读者将了解如何在快速访问工具栏上创建按钮以快速访问宏，并学习如何修改菜单或按钮以自定义其外观和功能。读者还将能够探索在Excel工作表上直接创建用于特定任务的按钮的过程，并熟练地编辑记录的宏以增强自动化并根据特定要求进行定制。
- en: '[Creating buttons on quick access Toolbar](contents.xhtml#sc2_210a)'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '[在快速访问工具栏上创建按钮](contents.xhtml#sc2_210a)'
- en: 'To create buttons on the Quick Access Toolbar, follow the given steps:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 要在快速访问工具栏上创建按钮，请按照以下步骤操作：
- en: Click on the Office button.
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击Office按钮。
- en: Click on Excel Options.
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击Excel选项。
- en: Go to Customize Tab.
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到自定义选项卡。
- en: Under Choose Commands From drop down box, select Macros.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在“从下拉框中选择命令”下，选择宏。
- en: Add your macro to Customize Quick Access Toolbar.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将您的宏添加到自定义快速访问工具栏。
- en: 'Refer to the following [Figure 15.1](#fig15-1):'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 参考以下[图15.1](#fig15-1)：
- en: '![](images/Figure_15.1.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](images/Figure_15.1.png)'
- en: 'Figure 15.1: Creating buttons on the Quick Access Toolbar'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.1：在快速访问工具栏上创建按钮
- en: '[Modifying menus or buttons](contents.xhtml#sc2_211a)'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '[修改菜单或按钮](contents.xhtml#sc2_211a)'
- en: 'Whenever you want to create a new button, edit the existing button or remove
    any button from the Quick Access Toolbar, follow the given steps:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 每当您想要创建新按钮，编辑现有按钮或从快速访问工具栏中删除任何按钮时，请按照以下步骤操作：
- en: Click on Modify… button.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击修改…按钮。
- en: Select an icon of your choice.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择您喜欢的图标。
- en: Mention the Display Name.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提及显示名称。
- en: Click OK.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击确定。
- en: 'Refer to the following [Figure 15.2](#fig15-2):'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 参考以下[图15.2](#fig15-2)：
- en: '![](images/Figure_15.2.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](images/Figure_15.2.png)'
- en: 'Figure 15.2: Modifying menus or buttons'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.2：修改菜单或按钮
- en: '[Scenario 4](contents.xhtml#sc3_212a)'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '[场景4](contents.xhtml#sc3_212a)'
- en: 'Create a macro which will extract region-wise sum of salary (use “Salary worksheet”).
    On clicking the “Subtotal” button, region-wise subtotal should be added on a new
    worksheet, as shown in the following [Figure 15.3](#fig15-3):'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个宏，该宏将提取按区域划分的薪水总和（使用“薪水工作表”）。单击“小计”按钮后，应在新工作表上添加按区域划分的小计，如下所示[图15.3](#fig15-3)：
- en: '![](images/Figure_15.3.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![](images/Figure_15.3.png)'
- en: 'Figure 15.3: Scenario 4'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.3：场景4
- en: 'For solve this scenario, follow these steps:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 要解决此场景，请按照以下步骤操作：
- en: Start recording (give name Subtotal_Macro)
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 开始录制（命名为Subtotal_Macro）
- en: Select the Salary sheet (source data)
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择薪水表（源数据）
- en: Select cell A1 (Database starts from A1)
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择A1单元格（数据库从A1开始）
- en: 'Perform Sort on Region, as shown in [Figure 15.4](#fig15-4):'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照[图15.4](#fig15-4)中显示的方式对区域进行排序：
- en: '![](images/Figure_15.4.png)'
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](images/Figure_15.4.png)'
- en: 'Figure 15.4: Scenario 4 solution'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图15.4：场景4解决方案
- en: 'Note: Sorting must be as per the requirement of Subtotal. Wrong sorting will
    result in wrong subtotal.'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意：排序必须按照小计的要求进行。错误的排序将导致错误的小计。
- en: 'Perform Subtotal on Region, as shown in [Figure 15.5](#fig15-5), and follow
    the given steps:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照[图15.5](#fig15-5)中显示的方式对区域进行小计，并按照给定的步骤操作：
- en: On Data Tab, go to the Outline Group.
  id: totrans-43
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在数据选项卡上，转到大纲组。
- en: Click on the Subtotal button.
  id: totrans-44
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击小计按钮。
- en: Also select Region in.
  id: totrans-45
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 也选择区域。
- en: Select Sum function (you can chose any other functions as per the requirement)
  id: totrans-46
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择求和函数（根据要求可以选择其他函数）
- en: Select Salary Field.
  id: totrans-47
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择“工资”字段。
- en: Click OK.
  id: totrans-48
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“确定”。
- en: 'Refer to [Figure 15.5](#fig15-5):'
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 参考[图 15.5](#fig15-5)：
- en: '![](images/Figure_15.5.png)'
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](images/Figure_15.5.png)'
- en: 'Figure 15.5: Scenario 4 solution'
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 15.5：场景 4 解决方案
- en: Click on Second level of Outline (only subtotal must be shown)
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击大纲的第二级（只显示小计）
- en: Select the data.
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择数据。
- en: Press Alt + ;(semi colon) key combination to select visible cells from the selection.
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下 Alt + ;（分号）键组合以从选择中选择可见单元格。
- en: Copy the selection (Ctrl + C).
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制所选内容（Ctrl + C）。
- en: Insert new worksheet (Shift + F11).
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 插入新工作表（Shift + F11）。
- en: Paste the copied data (Ctrl + V).
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 粘贴复制的数据（Ctrl + V）。
- en: Go to Salary sheet (source data).
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到工资表（源数据）。
- en: 'Remove Subtotal, using the following steps:'
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除小计，使用以下步骤：
- en: Go to Data Tab.Click Subtotal.
  id: totrans-60
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到“数据”选项卡。点击“小计”。
- en: Click on RemoveAll button.
  id: totrans-61
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“RemoveAll”按钮。
- en: Activate the previous sheet (Ctrl + PageUp).
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 激活上一个工作表（Ctrl + PageUp）。
- en: Stop Recording
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 停止录制
- en: 'Refer to the following [Figure 15.6](#fig15-6):'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 参考以下[图 15.6](#fig15-6)：
- en: '![](images/Figure_15.6.png)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![](images/Figure_15.6.png)'
- en: 'Figure 15.6: Scenario 4 solution'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.6：场景 4 解决方案
- en: '[Creating a button on Excel worksheet](contents.xhtml#sc2_213a)'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '[在 Excel 工作表上创建按钮](contents.xhtml#sc2_213a)'
- en: 'To create a button on the Excel worksheet, follow the given steps:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Excel 工作表上创建一个按钮，请按照以下步骤进行：
- en: Activate the salary sheet.
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 激活工资表。
- en: Go to Controls Group.
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到“控件”组。
- en: Select Button (Form Control), as shown in [Figure 15.7](#fig15-7) (b)
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择按钮（表单控件），如[图 15.7](#fig15-7)（b）所示
- en: Assign the subtotal_macro, as shown in [Figure 15.7](#fig15-7) (c)
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 分配小计宏，如[图 15.7](#fig15-7)（c）所示。
- en: Change the caption (right click and Edit Text), as shown in [Figure 15.7](#fig15-7)
    (d).
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更改标题（右键单击并编辑文本），如[图 15.7](#fig15-7)（d）所示。
- en: 'Refer to the following [Figure 15.7](#fig15-7):'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 参考以下[图 15.7](#fig15-7)：
- en: '![](images/Figure_15.7.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![](images/Figure_15.7.png)'
- en: 'Figure 15.7: Creating a button on the Excel worksheet'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.7：在 Excel 工作表上创建按钮
- en: '[Scenario 5](contents.xhtml#sc3_214a)'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '[场景 5](contents.xhtml#sc3_214a)'
- en: 'Create a macro which will extract records from different department and region.
    The user will type the required department and region and click on the filter
    button, as shown in [Figure 15.8](#fig15-8):'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个宏，将从不同部门和区域提取记录。用户将输入所需的部门和区域，然后点击筛选按钮，如[图 15.8](#fig15-8)所示：
- en: '![](images/Figure_15.8.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![](images/Figure_15.8.png)'
- en: 'Figure 15.8: [Scenario 5](#sc3_214)'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.8：[场景 5](#sc3_214)
- en: 'Note: The above macro will automate the job of Advance Filter.'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：上述宏将自动化高级筛选的工作。
- en: 'Follow the given steps:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤进行：
- en: Activate Salary sheet.
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 激活工资表。
- en: Create criteria range for Advance Filter.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为高级筛选创建条件范围。
- en: Start recording.
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 开始录制。
- en: Give name Filter_Macro.
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 给予名称“Filter_Macro”。
- en: Store in This workbook itself.
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 存储在本工作簿中。
- en: Click on heading of database (cell A5).
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击数据库的标题（单元格 A5）。
- en: Do an Advance Filter.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 进行高级筛选。
- en: Click Data tab.
  id: totrans-90
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“数据”选项卡。
- en: Click on Advanced.
  id: totrans-91
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“高级”。
- en: 'Refer to [Figure 15.9](#fig15-9):'
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 参考[图 15.9](#fig15-9)：
- en: '![](images/Figure_15.9.png)'
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](images/Figure_15.9.png)'
- en: 'Figure 15.9: [Scenario 5](#sc3_214) solution'
  id: totrans-94
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 15.9：[场景 5](#sc3_214) 解决方案
- en: Provide List range, that is, database range, as shown in [Figure 15.10](#fig15-10).
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供列表范围，即数据库范围，如[图 15.10](#fig15-10)所示。
- en: Provide Criteria Range.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供条件范围。
- en: Click OK.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“确定”。
- en: Stop Recording.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 停止录制。
- en: Create a button from Developer Tab | Controls Group.
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从“开发人员”选项卡 | “控件”组创建一个按钮。
- en: Assign Filter macro to this button.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将筛选宏分配给此按钮。
- en: 'Refer to [Figure 15.10](#fig15-10):'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 参考[图 15.10](#fig15-10)：
- en: '![](images/Figure_15.10.png)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![](images/Figure_15.10.png)'
- en: 'Figure 15.10: [Scenario 5](#sc3_214) solution'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.10：[场景 5](#sc3_214) 解决方案
- en: '[Editing the recorded macros](contents.xhtml#sc2_215a)'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: '[编辑记录的宏](contents.xhtml#sc2_215a)'
- en: Sometimes recorded macros may not give you full automation. Then you require
    to edit your recorded macros. Alternatively, you might want to add some actions
    in your recorded macro and then you can edit your macro.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 有时记录的宏可能无法完全自动化。然后你需要编辑你记录的宏。或者，你可能想在记录的宏中添加一些操作，然后你可以编辑你的宏。
- en: For example, in [Scenario 5](#sc3_214), instead of changing criteria in Excel,
    your macro should ask which region and dept. The user will type and then click
    OK. Then, the macro will perform the filter.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，在[场景 5](#sc3_214)中，不要在 Excel 中更改条件，而是让你的宏询问区域和部门。用户将输入然后点击“确定”。然后，宏将执行筛选。
- en: 'To edit your recorded macro, follow the given steps:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 要编辑你记录的宏，请按照以下步骤进行：
- en: Go to Tools.
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到“工具”。
- en: Click on Macro.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“宏”。
- en: Open Visual Basic Editor.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 Visual Basic 编辑器。
- en: Open the code window of your macro.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开你的宏的代码窗口。
- en: '[Scenario 6](contents.xhtml#sc3_216a)'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '[场景 6](contents.xhtml#sc3_216a)'
- en: 'Open [Scenario 5](#sc3_214) and modify the code to do the following. User should
    get an InputBox to type the required department and region and click filter button.
    Refer to [Figure 15.11](#fig15-11):'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 打开[场景5](#sc3_214)并修改代码以执行以下操作。用户应该获得一个InputBox来输入所需的部门和地区，然后单击筛选按钮。参考[图15.11](#fig15-11)：
- en: '![](images/Figure_15.11.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](images/Figure_15.11.png)'
- en: 'Figure 15.11: Scenario 6'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.11：场景6
- en: 'To edit your recorded macro, do the following steps:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 要编辑您录制的宏，请执行以下步骤：
- en: Go to Tools.
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到工具。
- en: Select Macro.
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择宏。
- en: Select Filter_Macro.
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择Filter_Macro。
- en: Click Edit, as shown in [Figure 15.12](#fig15-12).
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击编辑，如[图15.12](#fig15-12)所示。
- en: Open the code window of your macro.
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开您的宏的代码窗口。
- en: 'Refer to [Figure 15.12](#fig15-12):'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 参考[图15.12](#fig15-12)：
- en: '![](images/Figure_15.12.png)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![](images/Figure_15.12.png)'
- en: 'Figure 15.12: Scenario 6 solution'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.12：场景6解决方案
- en: Refer Training File3.xls.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 参考Training File3.xls。
- en: Macro definition starts with the keyword Sub and ends with the line End Sub.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 宏定义以关键字Sub开头，并以End Sub结束。
- en: Inputbox is a function used to take input from the end user.
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Inputbox是一个用于从最终用户获取输入的函数。
- en: Range is a class.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 范围是一个类。
- en: 'Note: We will discuss writing procedures later in detail.'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：我们将稍后详细讨论编写过程。
- en: 'Refer to [Figure 15.13](#fig15-13):'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 参考[图15.13](#fig15-13)：
- en: '![](images/Figure_15.13.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](images/Figure_15.13.png)'
- en: 'Figure 15.13: Scenario 6 Solution'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.13：场景6解决方案
- en: '[Scenario 7](contents.xhtml#sc3_217a)'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: '[场景7](contents.xhtml#sc3_217a)'
- en: 'Create a macro to import data from a txt file (sales.txt) and design a pivot
    table which shows product wise, month wise sum of sales. This macro will automate
    the import of data from txt file and create a pivot table report (refer Training
    File4.xls):'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个宏来从txt文件（sales.txt）导入数据并设计一个数据透视表，显示按产品和月份总销售额。此宏将自动化从txt文件导入数据并创建一个数据透视表报告（参考Training
    File4.xls）：
- en: '| Sum of Sales in figures |  |'
  id: totrans-135
  prefs: []
  type: TYPE_TB
  zh: '| 数字销售总和 |  |'
- en: '| product | month | Total |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
  zh: '| 产品 | 月份 | 总数 |'
- en: '| cd | jan feb | 100000 |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
  zh: '| 光盘 | 一月 二月 | 100000 |'
- en: '|  | mar | 7500012000 |'
  id: totrans-138
  prefs: []
  type: TYPE_TB
  zh: '|  | 三月 | 7500012000 |'
- en: '| cd Total | 187000 |'
  id: totrans-139
  prefs: []
  type: TYPE_TB
  zh: '| 光盘总数 | 187000 |'
- en: '| Monitor jan feb |  | 1500020000 |'
  id: totrans-140
  prefs: []
  type: TYPE_TB
  zh: '| 显��器 一月 二月 |  | 1500020000 |'
- en: '| Monitor Total | 35000 |'
  id: totrans-141
  prefs: []
  type: TYPE_TB
  zh: '| 显示器总数 | 35000 |'
- en: '| pen drive | jan | 75000 |'
  id: totrans-142
  prefs: []
  type: TYPE_TB
  zh: '| 闪存 | 一月 | 75000 |'
- en: '|  | mar | 73000 |'
  id: totrans-143
  prefs: []
  type: TYPE_TB
  zh: '|  | 三月 | 73000 |'
- en: '| pen drive Total | 148000 |'
  id: totrans-144
  prefs: []
  type: TYPE_TB
  zh: '| 闪存总数 | 148000 |'
- en: '| Grand Total | 370000 |'
  id: totrans-145
  prefs: []
  type: TYPE_TB
  zh: '| 总计 | 370000 |'
- en: 'Table 15.1: Sample data'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 表15.1：示例数据
- en: 'To solve this scenario, follow these steps:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 要解决这种情况，请按照以下步骤操作：
- en: Start recording (name it as import_txt)
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 开始录制（命名为import_txt）
- en: Click on Data menu.
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击数据菜单。
- en: Select Import External data | Import data.
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择导入外部数据 | 导入数据。
- en: Select sales.txt.
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择sales.txt。
- en: Select data type as Delimited, as shown in [Figure 15.14](#fig15-14) (1).
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择数据类型为分隔符，如[图15.14](#fig15-14)所示（1）。
- en: Click Next
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击下一步
- en: Select delimiter (comma), as shown in [Figure 15.14](#fig15-14) (2).
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择分隔符（逗号），如[图15.14](#fig15-14)所示（2）。
- en: Click Next.
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击下一步。
- en: '![](images/Figure_15.14.png)'
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](images/Figure_15.14.png)'
- en: 'Figure 15.14: Scenario 7 solution'
  id: totrans-157
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图15.14：场景7解决方案
- en: Select the type of each data, as shown in [Figure 15.15](#fig15-15).
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择每个数据的类型，如[图15.15](#fig15-15)所示。
- en: Click Finish.
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击完成。
- en: Select existing sheet option, as shown in [Figure 15.15](#fig15-15).
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择现有工作表选项，如[图15.15](#fig15-15)所示。
- en: Click OK.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击确定。
- en: Now create a pivot using imported data and place it in new worksheet.
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在使用导入的数据创建一个数据透视表，并将其放在新工作表中。
- en: Stop recording.
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 停止录制。
- en: '![](images/Figure_15.15.png)'
  id: totrans-164
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](images/Figure_15.15.png)'
- en: 'Figure 15.15: Scenario 7 solution'
  id: totrans-165
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图15.15：场景7解决方案
- en: '[Scenario 8](contents.xhtml#sc3_218a)'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '[场景8](contents.xhtml#sc3_218a)'
- en: 'Refer Training File4.xls:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 参考Training File4.xls：
- en: Scenario – 8
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 场景-8
- en: '| Purpose | Original Code | Modified Code |'
  id: totrans-169
  prefs: []
  type: TYPE_TB
  zh: '| 目的 | 原始代码 | 修���后的代码 |'
- en: '| For file selection | ActiveSheet.QueryTables.Ad d(Connection:=”TEXT;c:\vb
    a\sales.txt”,Destination:=Ran ge(“A1”)) | ActiveSheet.QueryTables.Add(C onnection:=”TEXT;”
    & Application.GetOpenFilename, Destination:=Range(“A1”)) |'
  id: totrans-170
  prefs: []
  type: TYPE_TB
  zh: '| 用于文件选择 | ActiveSheet.QueryTables.Ad d(Connection:=”TEXT;c:\vb a\sales.txt”,Destination:=Ran
    ge(“A1”)) | ActiveSheet.QueryTables.Add(C onnection:=”TEXT;” & Application.GetOpenFilename,
    Destination:=Range(“A1”)) |'
- en: '| For variable length data | ActiveWorkbook.PivotCache s.Add(SourceType:=xlDatab
    ase, SourceData:= “Sheet31!R1C1:R7C3”).CreatePivotTable | ActiveWorkbook.PivotCaches.A
    dd(SourceType:=xlDatabase, SourceData:=Range(“a1”).CurrentRegion.A ddress).CreatePivotTable
    |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '| 对于可变长度数据 | ActiveWorkbook.PivotCache s.Add(SourceType:=xlDatab ase, SourceData:=
    “Sheet31!R1C1:R7C3”).CreatePivotTable | ActiveWorkbook.PivotCaches.A dd(SourceType:=xlDatabase,
    SourceData:=Range(“a1”).CurrentRegion.A ddress).CreatePivotTable |'
- en: '[Practice 1](contents.xhtml#sc2_219a)'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: '[练习1](contents.xhtml#sc2_219a)'
- en: Create a macro (Report_title) which will add a new worksheet with following
    details in the existing Workbook cell address cell content.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个宏（Report_title），它将在现有工作簿的单元格地址单元格内容中添加一个新工作表，并包含以下详细信息。
- en: 'A2: Your company name'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: A2：您的公司名称
- en: 'A3: Title as “Daily report”'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: A3：标题为“每日报告”
- en: 'A4: Today‟s date'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: A4：今天的日期
- en: 'A6: Sr.No.'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: A6：序号
- en: 'B6: Product'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: B6：产品
- en: 'C6: Quantity Sold'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: C6：销售数量
- en: 'Follow the given steps for the solution:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 按照给定的步骤解决问题：
- en: Click on Tools | Macro.
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“工具” | “宏”。
- en: Select Record New Macro.
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择记录新宏。
- en: Type name of the macro as Report_title.
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将宏的名称命名为“报告标题”。
- en: Assign shortcut key.
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 分配快捷键。
- en: Select the location to store.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择存储位置。
- en: Add details in the Description box.
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在描述框中添加详细信息。
- en: Click on OK.
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“确定”。
- en: Add a blank worksheet (Shift+F11 or Insert menu | worksheet)
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一个空白工作表（Shift+F11或插入菜单 | 工作表）
- en: Click on A2 and type your company name.
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击A2并输入你公司的名称。
- en: Click on A3, type tile as “Daily report”.
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击A3，输入标题为“每日报告”。
- en: Click on A4, type “=today()”.
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击A4，输入“=today()”。
- en: From A6 to C6 type “Sr. No.”, “Product” and “Quantity Sold”
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从A6到C6输入“序号”、“产品”和“销售数量”
- en: Stop recording.
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 停止录制。
- en: '[Practice 2](contents.xhtml#sc2_220a)'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: '[练习2](contents.xhtml#sc2_220a)'
- en: Create a macro to add signature, that is, your name and designation at the end
    of the data.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个宏，添加签名，即您的姓名和职务在数据末尾。
- en: 'Note: Consider that the worksheet is in the format of Practice 1.'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：假设工作表的格式是练习1。
- en: This macro always adds a worksheet before current worksheet. Modify that macro
    such that it will add new worksheet after current worksheet
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 这个宏总是在当前工作表之前添加一个工作表。修改该宏，使其在当前工作表之后添加新工作表。
- en: 'Follow the given steps for the solution:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 按照给定的步骤解决问题：
- en: Click on Tools | Macro.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“工具” | “宏”。
- en: Select Record New Macro.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择记录新宏。
- en: Type name of the macro as summary.
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将宏的名称命名为“汇总”。
- en: Assign a shortcut key.
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 分配一个快捷键。
- en: Select the location to store the macro.
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择存储宏的位置。
- en: Add details in the Description box.
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在描述框中添加详细信息。
- en: Click on OK.
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“确定”。
- en: Click on cell A6.
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击单元格A6。
- en: Use Ctrl + Down Arrow to reach end of the data.
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用Ctrl + ↓到达数据末尾。
- en: Click on Relative Reference.
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“相对引用”。
- en: Now move 3 rows down and type your name and designation.
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在向下移动3行，输入你的姓名和职务。
- en: Switch off Relative Reference.
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 关闭相对引用。
- en: Stop recording.
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 停止录制。
- en: Modify a statement “Sheets.add” to “sheets.add after:=activesheet”.
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改语句“Sheets.add”为“sheets.add after:=activesheet”。
- en: '[Conclusion](contents.xhtml#sc2_221a)'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: '[结论](contents.xhtml#sc2_221a)'
- en: In this chapter, we covered the topic of assigning buttons to macros in Excel.
    We learned how to create buttons on the Quick Access Toolbar and customize them
    by modifying menus or buttons. Additionally, we explored the process of creating
    buttons directly on an Excel worksheet. We also discussed editing recorded macros
    to enhance their functionality.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们讨论了在Excel中为宏分配按钮的主题。我们学习了如何在快速访问工具栏上创建按钮，并通过修改菜单或按钮来自定义它们。此外，我们探讨了直接在Excel工作表上创建按钮的过程。我们还讨论了编辑记录的宏以增强其功能的过程。
- en: '[Exercise](contents.xhtml#sc2_222a)'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: '[练习](contents.xhtml#sc2_222a)'
- en: Create a macro to extract region-wise sum of salary and add it to a new worksheet.
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个宏，提取按地区汇总的工资总和，并将其添加到新工作表中。
- en: Create a macro to filter records based on department and region.
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个宏，根据部门和地区筛选记录。
- en: Import data from a text file and create a pivot table report.
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从文本文件导入数据并创建数据透视表报告。
- en: Modify the code for file selection and variable length data in existing macros.
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改现有宏中的文件选择和变量长度数据的代码。
- en: Practice creating a macro to add a daily report title in a worksheet.
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 练习创建一个宏，在工作表中添加每日报告标题。
- en: Practice creating a macro to add a signature at the end of the data.
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 练习创建一个宏，在数据末尾添加签名。
- en: Join our book’s Discord space
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 加入我们书籍的Discord空间
- en: 'Join the book’s Discord Workspace for Latest updates, Offers, Tech happenings
    around the world, New Release and Sessions with the Authors:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 加入书籍的Discord Workspace，获取最新更新、优惠、全球技术动态、新发布和作者会话：
- en: '**[https://discord.bpbonline.com](https://discord.bpbonline.com)**'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: '**[https://discord.bpbonline.com](https://discord.bpbonline.com)**'
- en: '![](images/fm1.png)'
  id: totrans-225
  prefs: []
  type: TYPE_IMG
  zh: '![](images/fm1.png)'
