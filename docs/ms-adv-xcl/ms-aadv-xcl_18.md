# 第十七章 VBA 中的条件语句

介绍

在 Visual Basic for Applications（VBA）中，条件语句用于根据特定条件在代码中做出决策。它们允许您根据逻辑表达式的结果执行不同的代码块。在本章中，我们将重点介绍 VBA 中两种常用的条件语句：选择情况和如果…那么结束如果。

结构

在本章中，我们将讨论以下主题：

+   如果…那么结束如果

+   选择情况

+   选择情况 Vs. 如果…那么结束如果

目标

通过本章的学习，读者将了解 VBA 中选择情况和如果…那么结束如果语句之间的区别，并学会在不同场景中正确使用它们。

如果…那么结束如果

在 VBA 中，“如果…那么结束如果”语句用于评估条件并在条件为真时执行一段代码块。它还可以与“否则如果”和“否则”子句结合使用以处理多个条件。以下是“如果…那么结束如果”语句的基本语法示例：

| 如果 条件 1 那么' 如果条件 1 为真，则执行的代码块否则如果 条件 2 那么' 如果条件 2 为真且条件 1 为假，则执行的代码块否则' 如果前面的条件都不为真，则执行的代码块结束如果 |
| --- |

上述示例中的“条件”和“条件 2”是布尔表达式，其结果为真或假。

需要注意的是，“如果…那么结束如果”语句可以嵌套在其他控制结构中，如循环中，并且可以与其他语句和关键字结合使用，以在您的 VBA 代码中创建更复杂的逻辑。

示例

如果分数等于或大于 90，则显示“等级：A”。如果在 80 到 89 之间，则显示“等级：B”，依此类推。如果分数不符合任何指定条件，则显示“等级：F”。

| 子 评分评估()如分数为整数' 提示用户输入分数分数 = 输入框("输入分数：")' 评估分数并提供相应等级如果 分数 >= 90 则消息框 "等级：A"否则如果 分数 >= 80 则消息框 "等级：B"否则如果 分数 >= 70 则消息框 "等级：C"否则如果 分数 >= 60 则消息框 "等级：D"否则消息框 "等级：F"结束 如果结束 子 |
| --- |

选择情况

VBA 中的选择情况语句提供了一种简洁和结构化的方式来处理多个条件，并根据单个表达式的值执行不同的代码块。以下是其语法和用法的全面解释：

| 选择情况 表达式情况 值 1' 如果表达式匹配值 1，则执行的代码情况 值 2' 如果表达式匹配值 2，则执行的代码情况 其他' 如果表达式与任何先前情况都不匹配，则执行的代码结束选择 |
| --- |

示例

在这个示例中，程序提示用户输入一个水果名称。然后，Select Case 语句评估输入并根据所选水果显示相应的消息。如果水果是“苹果”，它会显示有关其健康选择的消息。如果是“香蕉”，它会提到其钾含量。如果是“橙子”或“柑橘”，它会突出柑橘的好处。对于任何其他输入，它会显示一个通用消息。

| Sub FruitSelection()Dim fruit As String' 提示用户输入一个水果名称 fruit = InputBox("请输入一个水果名称：")' 评估水果名称并显示相应的消息 Select Case fruitCase "apple"MsgBox "你选择了一个苹果。这是一个健康的选择！"Case "banana"MsgBox "你选择了一个香蕉。它是钾的良好来源。"Case "orange", "mandarin"MsgBox "你选择了一个橙子或柑橘。享受柑橘的好处！"Case ElseMsgBox "这是一个有趣的选择！"End SelectEnd Sub |
| --- |

Select Case Vs. If … End If

当将一个表达式与几个不同的值进行比较时，使用 Select Case 语句作为 If...Then...Else 语句中 ElseIf 的替代方法。

虽然 If...Then...Else 语句可以为每个 ElseIf 语句评估不同的表达式，但 Select Case 语句仅在控制结构的顶部评估一次表达式。

结论

在本章中，我们探讨了 VBA 中 Select Case 和 If...End If 语句之间的区别。我们了解到，当您有多个条件要评估针对单个表达式时，Select Case 是一个有用的替代方案。它简化了您的代码并提高了可读性。然而，当您有不同且无关的条件要考虑时，If...End If 语句更合适。

练习

1.  编写一个 VBA 程序，询问用户输入一周中的一天（从 1 到 7 的数字），并显示相应的星期几名称。使用 Select Case 和 If...End If 语句来实现该程序。

1.  编写一个 VBA 程序，询问用户输入一个数字，并确定它是正数、负数还是零。使用 Select Case 和 If...End If 语句来实现该程序。

加入我们书籍的 Discord 空间

加入本书的 Discord 工作空间，了解最新更新、优惠、世界各地的技术动态、新发布和作者的会议：

**[`discord.bpbonline.com`](https://discord.bpbonline.com)**

![](img/fm1.png)
