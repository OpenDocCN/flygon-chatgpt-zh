# [第10章条件格式设置](contents.xhtml#ch10a)

[介绍](contents.xhtml#sc2_125a)

Excel中的条件格式设置允许我们根据特定条件将格式设置规则应用于单元格或范围。它帮助我们突出重要信息，可视化数据趋势，并使我们的工作表更具视觉吸引力。在本章中，我们将探讨不同类型的条件格式设置，例如基于单元格值或公式的格式设置，使用图标集，以及使用数据库案例研究将条件格式设置应用于现实场景。通过本章结束时，您将对如何有效使用条件格式设置来增强Excel中的数据分析有扎实的理解。

[结构](contents.xhtml#sc2_126a)

在本章中，我们将讨论以下主题：

+   条件格式设置

    +   使用单元格值进行条件格式设置（基于列的条件格式设置）

    +   使用公式进行条件格式设置（基于记录的条件格式设置）

+   图标集

+   具有多个条件的公式

[目标](contents.xhtml#sc2_127a)

学习完本章后，读者将能够定义条件格式设置并识别应用条件格式设置的方法。他们还将学习如何应用具有多个条件的公式。

[条件格式设置](contents.xhtml#sc2_128a)

当数据需要根据特定条件进行格式化时，我们可以使用条件格式设置。通过使用数据条、颜色刻度或图标集，可以轻松突出显示单元格或单元格范围，强调异常值，并通过可视化数据来可视化数据。条件格式设置会根据条件（或标准）更改单元格范围的外观。如果条件为真，则根据该条件格式化单元格范围。如果条件为假，则不会格式化单元格范围。参考[图10.1](#fig10-1)：

![](images/Figure_10.1.png)

图10.1：条件格式设置

您可以根据需要选择以下任何一种格式：

+   通过使用双色刻度格式化所有单元格。

+   通过使用三色刻度格式化所有单元格。

+   通过使用数据条格式化所有单元格。

+   通过图标集格式化所有单元格。

+   仅格式化包含文本、数字或日期/时间值的单元格。

+   仅格式化前几名或末尾几名的值。

+   仅格式化高于或��于平均值的值。

+   仅格式化唯一或重复值。

+   比较表列以确定要格式化的单元格。

+   使用公式确定要格式化的单元格。

+   清除条件格式。

例如，您可以将所有销售额超过75,000的数字标记为绿色。条件格式设置可以基于单元格值或公式应用。

注意：在应用条件格式设置之前选择的区域决定了格式将应用到工作表的区域。

[使用单元格值进行条件格式设置（基于列的条件格式设置）](contents.xhtml#sc3_129a)

要根据单元格值应用底纹，可以按照以下步骤进行操作：

1.  选择要应用条件着色的单元格。

1.  激活工作表功能区。

1.  在样式组中，点击条件格式化。

1.  从出现的画廊中选择突出显示单元格规则。

1.  从菜单中选择单元格中值的条件或选择更多规则。

1.  指定条件和单元格着色。

1.  点击确定应用格式。

[使用公式进行条件格式化（基于记录的条件格式化）](contents.xhtml#sc3_130a)

要基于公式应用条件格式化，请按照以下步骤操作：

1.  选择要应用格式的单元格。

1.  在样式功能区组中，点击条件格式化。

1.  从菜单中选择条件格式规则图例，打开格式规则图例对话框。

1.  点击新建规则，打开添加格式规则对话框。

1.  在“选择规则类型”框中，选择使用公式确定要格式化的单元格。

1.  在“当此公式为真时格式值”框中，输入一个评估为真或假的值的公式。

1.  点击格式，打开格式单元格对话框，如[图 10.2](#fig10-2)所示。

1.  在“单元格格式”对话框中，指定满足条件的单元格应该显示的格式，然后点击确定。

1.  点击确定关闭添加格式规则对话框。

1.  点击确定关闭格式规则图例对话框并应用格式。

注意：如果需要将格式应用于整个数据库，在应用条件格式之前选择带有或不带有标题的数据库。但是，公式应该应用于选择中的第一行。

示例：

[图 10.2](#fig10-2)描述了如果选择与列标题一起的记录，突出显示销售部门所有人员的公式。

要突出显示薪水最高的人员的记录，如果我们选择了不带标题的数据库，则需要使用以下公式：

| =$h2=max($H$2:$H$101) |
| --- |

参考以下[图 10.2](#fig10-2)：

![](images/Figure_10.2.png)

图 10.2：新格式规则

[图标集](contents.xhtml#sc2_131a)

在 Excel 中，您可以访问更多的图标集，包括三角形、星星和方框。您还可以混合和匹配来自不同图标集的图标，并更容易地隐藏图标。例如，您可以选择仅显示高利润值的图标，并省略中间和较低值的图标。

[具有多个条件的公式](contents.xhtml#sc2_132a)

如果我们只想突出显示东部地区的销售部门，我们可以按照以下步骤更改公式：

1.  选择不带标题的范围。

1.  点击主页选项卡。

1.  选择条件格式化。

1.  点击新建规则。

1.  输入公式 =AND($D2="销售部门",$E2="东部地区")

1.  选择所需的格式。

1.  点击确定应用并关闭。

根据不同工作表的单元格引用应用条件公式

假设我们想要通过使用另一个工作表的单元格引用来突出显示记录。在这种情况下，请按照以下步骤操作：

1.  选择整个数据而不包括标题。

1.  点击主页选项卡 | 条件格式 | 管理规则。

1.  点击新规则。

1.  将规则类型选择为使用公式确定要格式化的单元格。

1.  在编辑规则描述中，键入公式：=$D2=’cross sheet’!$B$

1.  选择所需的格式。

1.  点击确定以应用并关闭对话框。

[结论](contents.xhtml#sc2_133a)

总的来说，Excel中的条件格式化是一个有价值的功能，它允许我们根据特定条件应用格式。它帮助我们突出重要数据，可视化趋势，并增强我们工作表的呈现。通过掌握条件格式化技巧，我们可以使我们的数据更具视觉吸引力，并获得有价值的见解。

[练习](contents.xhtml#sc2_134a)

打开来自练习文件夹中的Excel_Basic的发票工作表，并按照以下步骤获取结果：

1.  使用Vlookup获取客户类型和费率。

1.  创建6份发票工作表的副本并解决其他问题。

1.  对记录进行排序[零售商，直销/批发商。

1.  筛选6月份销售价格在3000-5000之间的记录。

1.  为零售商和批发商数量在100-150和250-500之间的记录进行筛选。

1.  根据类型和客户智能总计记录的小计数量和总金额。

1.  创建一个按月份/客户智能总计数量/总金额和金额百分比的摘要报告。

1.  突出显示名称为“直销”的客户类型的行。

加入我们书籍的Discord空间

加入书籍的Discord工作区，获取最新更新、优惠、世界各地的技术动态、新发布和与作者的会话：

**[https://discord.bpbonline.com](https://discord.bpbonline.com)**

![](images/fm1.png)
