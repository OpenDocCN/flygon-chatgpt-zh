- en: '[CHAPTER 7Filtering a Database](contents.xhtml#ch07a)'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[第7章 数据库筛选](contents.xhtml#ch07a)'
- en: '[Introduction](contents.xhtml#sc2_84a)'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '[介绍](contents.xhtml#sc2_84a)'
- en: In this chapter, we will explore the topic of filtering a database in Excel.
    Filtering allows us to display only the rows of information that meet specific
    criteria, making it easier to analyze and work with large datasets. We will learn
    about different types of filters, including the AutoFilter feature, number, text,
    and date filters, as well as the advanced filtering capabilities of Excel. Additionally,
    we will discover how to filter for unique records in a list. By the end of this
    chapter, readers will have a clear understanding of how to effectively use filters
    in Excel to extract and manipulate data based on specific criteria.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将探讨在Excel中对数据库进行筛选的主题。筛选允许我们仅显示符合特定标准的信息行，使得分析和处理大型数据集变得更加容易。我们将了解不同类型的筛选器，包括自动筛选功能，数字、文本和日期筛选器，以及Excel的高级筛选功能。此外，我们将发现如何筛选列表中的唯一记录。通过本章的学习，读者将清楚地了解如何有效地在Excel中使用筛选器根据特定标准提取和操作数据。
- en: '[Structure](contents.xhtml#sc2_85a)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[结构](contents.xhtml#sc2_85a)'
- en: 'In this chapter, we will go over the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论以下主题：
- en: Filters
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 筛选器
- en: Auto filter
  id: totrans-6
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自动筛选
- en: Number, text or date filters
  id: totrans-7
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数字、文本或日期筛选器
- en: Filtering a list using advanced filter
  id: totrans-8
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用高级筛选筛选列表
- en: Filtering unique records
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 筛选唯一记录
- en: '[Objectives](contents.xhtml#sc2_86a)'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '[目标](contents.xhtml#sc2_86a)'
- en: After studying this chapter, the readers will be able to understand the various
    types of filters and also learn how to use them in their worksheet.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在学习本章后，读者将能够了解各种类型的筛选器，并学会如何在他们的工作表中使用它们。
- en: '[Filters](contents.xhtml#sc2_87a)'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '[筛选器](contents.xhtml#sc2_87a)'
- en: At times, you need to display only those rows of information that meet specific
    criteria. To help you do this, you may use a Filter. Let us discuss more about
    filters.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，您需要仅显示符合特定标准的信息行。为了帮助您做到这一点，您可以使用筛选器。让我们更多地讨论筛选器。
- en: '[Auto filter](contents.xhtml#sc3_88a)'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '[自动筛选](contents.xhtml#sc3_88a)'
- en: 'For commonly used criteria, excel provides the AutoFilter feature. Here is
    how it works:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 对于常用标准，Excel提供了自动筛选功能。以下是它的工作原理：
- en: Select any cell in the list.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择列表中的任何单元格。
- en: Activate the Data tab.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 激活“数据”选项卡。
- en: In the Sort & Filter group, click Filter to display the AutoFilter arrows next
    to each column heading.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在“排序和筛选”组中，单击“筛选”以显示每个列标题旁边的自动筛选箭头。
- en: From the list for the column by which you want to filter.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从您想要筛选的列的列表中选择。
- en: Select the criteria.
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择标准。
- en: 'Click OK, as shown in [Figure 7.1](#fig7-1):'
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击确定，如[图 7.1](#fig7-1)所示：
- en: '![](images/Figure_7.1.png)'
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](images/Figure_7.1.png)'
- en: 'Figure 7.1: Filter'
  id: totrans-23
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 7.1：筛选器
- en: To clear the filter and show the entire list, click on filter again. You can
    filter a list based on more complex criteria by using Excel’s Advanced Filtering
    features. For example, you can display the records of all those employees whose
    salary is between 7000 and 12000.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 要清除筛选并显示整个列表，请再次单击筛选。您可以使用Excel的高级筛选功能根据更复杂的标准筛选列表。例如���您可以显示所有那些薪水在7000到12000之间的员工的记录。
- en: 'Excel provides two tools for specifying complex filter criteria:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: Excel提供了两种指定复杂筛选条件的工具：
- en: Number, text or date filters
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数字、文本或日期筛选器
- en: Advanced filter
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 高级筛选
- en: '[Number, text or date filters](contents.xhtml#sc3_89a)'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '[数字、文本或日期筛选器](contents.xhtml#sc3_89a)'
- en: 'Once you add a filter to data, you also get a Number, Text or Date Filter option
    in each field depending on the type of data in that column. These can be used
    for field specific filtering like “Begins With”, “Contains” for text fields, “Greater
    Than”, “Less Than”, “Between” for number fields or “Before”, “After” for date
    fields. Every filter field has a Custom Filter option where you may specify formulas
    or options other than the ones that are already provided. Refer to [Figure 7.2](#fig7-2):'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦向数据添加筛选器，每个字段都会根据该列中的数据类型获得数字、文本或日期筛选器选项。这些可以用于字段特定的筛选，如文本字段的“以...开头”，“包含”，数字字段的“大于”，“小于”，“介于”，日期字段的“之前”，“之后”。每个筛选字段都有一个自定义筛选选项，您可以在其中指定除已提供的选项之外的公式或选项。参考[图
    7.2](#fig7-2)：
- en: '![](images/Figure_7.2.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](images/Figure_7.2.png)'
- en: 'Figure 7.2: Number Filter'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.2：数字筛选器
- en: 'Refer to the following [Figure 7.3](#fig7-3):'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 参考以下[图 7.3](#fig7-3)：
- en: '![](images/Figure_7.3.png)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![](images/Figure_7.3.png)'
- en: 'Figure 7.3: Text Filter'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.3：文本筛选器
- en: 'Refer to the following [Figure 7.4](#fig7-4):'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 参考以下[图 7.4](#fig7-4)：
- en: '![](images/Figure_7.4.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![](images/Figure_7.4.png)'
- en: 'Figure 7.4: Date Filter'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.4：日期筛选器
- en: From the drop-down list of the column for which you want to create criteria,
    choose Text Filters, Date Filters or Number Filters, click on Custom to display
    the Custom AutoFilter dialog box.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 从要创建条件的列的下拉列表中，选择文本筛选器、日期筛选器或数字筛选器，单击自定义以显示自定义自动筛选对话框。
- en: Enter a comparison criterion below the cell that contains the criteria label.
    You may use same row for “AND” criteria and different rows for “OR” criteria.
    For example, the criteria given in [Figure 7.5](#fig7-5) can be used to display
    only records of people in north or south regions.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在包含条件标签的单元格下方输入比较标准。您可以在同一行中使用“AND”条件，也可以在不同行中使用“OR”条件。例如，[图 7.5](#fig7-5)中给出的条件可用于仅显示北部或南部地区的人员记录。
- en: '![](images/Figure_7.5.png)'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](images/Figure_7.5.png)'
- en: 'Figure 7.5: Criteria range'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 7.5：条件范围
- en: Activate the Data tab.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 激活数据选项卡。
- en: In the Sort & Filter group, click Advanced to open the Advanced Filter dialog
    box. (as shown in [Figure 7.6](#fig7-6)).
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在“排序和筛选”组中，单击“高级”以打开高级筛选对话框（如[图 7.6](#fig7-6)所示）。
- en: '![](images/Figure_7.6.png)'
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](images/Figure_7.6.png)'
- en: 'Figure 7.6: Advanced Filter'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 7.6：高级筛选
- en: In the List Range box, select the cell range you want to filter. The cell range
    must include the associated column headings.
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在“列表范围”框中，选择要筛选的单元格范围。单元格范围必须包括相关的列标题。
- en: '[Filtering a list using advanced filter](contents.xhtml#sc3_90a)'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '[使用高级筛选筛选列表](contents.xhtml#sc3_90a)'
- en: If you wish to filter your data such that only the records of employees of Sales
    and admin departments from north and south region who earns between 7000-12000
    or 15000-20000 are displayed, auto filter will not serve the purpose. This is
    because one number filter cannot be applied over another in Auto Filter. However,
    the above query requires us to do just the same on salary field. So, to solve
    this query, we may have to use Advanced-Filter.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望筛选数据，以便仅显示销售和行政部门员工的记录，这些员工来自北部和南部地区，工资在 7000-12000 或 15000-20000 之间，自动筛选将无法实现目的。这是因为在自动筛选中无法对另一个数字筛选应用另一个数字筛选。然而，上述查询要求我们在工资字段上执行相同操作。因此，为了解决此查询，我们可能需要使用高级筛选。
- en: While using Advanced Filter, we need to have a criteria range and a list range.
    List range is your database.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用高级筛选时，我们需要有一个条件范围和一个列表范围。列表范围是您的数据库。
- en: To create a criteria range, we need to make a copy of the column header of the
    database.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要创建条件范围，我们需要复制数据库的列标题。
- en: In the Criteria Range box, select the cell range that contains your criteria
    and then click OK.
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在“条件范围”框中，选择包含您的条件的单元格范围，然后单击“确定”。
- en: 'Note: While designing the criteria range, it is better to copy and paste the
    column header of the entire database as the heading of the criteria range.'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：在设计条件范围时，最好将整个数据库的列标题复制并粘贴为条件范围的标题。
- en: For better visibility, keep the criteria range and list range on different rows.
    The Advanced Filter command filters your list in place, as Auto Filter does, but
    it does not display dropdown lists for columns. Instead, you have to select the
    List Range i.e. your data, type criteria in a criteria range on your worksheet
    and select the Criteria Range and in output range type the cell address where
    you want to display the output. It is optional.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地可见性，将条件范围和列表范围放在不同的行上。高级筛选命令会在原地筛选您的列表，就像自动筛选一样，但它不会为列显示下拉列表。相反，您必须选择列表范围，即您的数据，在工作表上的条件范围中输入条件，并选择条件范围，在输出范围中输入要显示输出的单元格地址。这是可选的。
- en: '[Filtering unique records](contents.xhtml#sc2_91a)'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '[筛选唯一记录](contents.xhtml#sc2_91a)'
- en: 'Advanced filter can also be used to filter out unique values in a list at a
    separate location. Though remove duplicates functionality of excel can help in
    creating a list of unique values in a list, you would need to copy paste the unique
    values, if you need it at a different location. To avoid this, use the advance
    filter option as follows:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 高级筛选也可用于在不同位置筛选列表中的唯一值。虽然 Excel 的删除重复功能可以帮助创建唯一值列表，但如果需要在不同位置复制粘贴唯一值，则需要这样做。为了避免这种情况，请按照以下步骤使用高级筛选选项：
- en: Select the column or click a cell in the range or list you want to filter.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择要筛选的列或单击范围或列表中的单元格。
- en: On the Data tab, click Filter.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在“数据”选项卡上，单击“筛选”。
- en: Click Advanced Filter.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击“高级筛选”。
- en: 'Do one of the following:'
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行以下操作之一：
- en: To filter the range or list in place, similar to using AutoFilter, click Filter
    the list, in-place.
  id: totrans-60
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要在原地筛选范围或列表，类似于使用自动筛选，请单击“在原地筛选列表”。
- en: To copy the results of the filter to another location, click Copy to another
    location. Then, in the Copy to box, enter a cell reference.
  id: totrans-61
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要将筛选结果复制到另一个位置，请单击“复制到另一个位置”。然后，在“复制到”框中，输入单元格引用。
- en: To select a cell, click Collapse Dialog to temporarily hide the dialog box.
    Select the cell on the worksheet, and then press Expand Dialog.
  id: totrans-62
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要选择单元格，请单击“折叠对话框”以暂时隐藏对话框。在工作表上选择单元格，然后按“展开对话框”。
- en: Select the Unique records only check box.
  id: totrans-63
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 仅选择“唯一记录”复选框。
- en: 'Note: Advanced filter, copy to option copies on a same worksheet, if you want
    to copy the Filter data into different worksheet, select the Advanced Filter command
    while you are at the worksheet where you want the data to be placed.'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：高级筛选，复制选项会在同一工作表上复制，如果要将筛选数据复制到不同的工作表，请在要放置数据的工作表上选择高级筛选命令。
- en: '[Conclusion](contents.xhtml#sc2_92a)'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '[结论](contents.xhtml#sc2_92a)'
- en: Filtering a database in Excel allows us to extract specific information based
    on criteria we define. In this chapter, we learned about AutoFilter, number/text/date
    filters, and advanced filtering. We also explored filtering for unique records.
    By mastering these techniques, we can efficiently analyze data and make informed
    decisions. In the next chapter, we will delve into the powerful capabilities of
    sorting data in Excel.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 在Excel中对数据库进行筛选允许我们根据我们定义的标准提取特定信息。在本章中，我们学习了AutoFilter、数字/文本/日期筛选和高级筛选。我们还探讨了筛选唯一记录的方法。通过掌握这些技巧，我们可以高效地分析数据并做出明智的决策。在下一章中，我们将深入探讨Excel中数据排序的强大功能。
- en: '[Exercise](contents.xhtml#sc2_93a)'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '[练习](contents.xhtml#sc2_93a)'
- en: 'Open the sheet named Filter. Use AutoFilter to find the records according to
    following criteria:'
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开名为Filter的工作表。使用AutoFilter根据以下标准查找记录：
- en: People from North or South
  id: totrans-69
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 来自北方或南方的人员
- en: People working in sales or admin
  id: totrans-70
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在销售或行政部门工作的人员
- en: People working in sales or admin, north or south whose salary is between 7000
    and 12000
  id: totrans-71
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在销售或行政部门工作的人员，北方或南方，薪水在7000至12000之间
- en: People working in sales or admin, north or south whose salary is between 7000
    and 12000 or between 15000 and 20000
  id: totrans-72
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在销售或行政部门工作的人员，北方或南方，薪水在7000至12000之间或在15000至20000之间
- en: Join our book’s Discord space
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 加入我们书籍的Discord空间
- en: 'Join the book’s Discord Workspace for Latest updates, Offers, Tech happenings
    around the world, New Release and Sessions with the Authors:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 加入书籍的Discord Workspace，获取最新更新、优惠、全球科技动态、新发布和作者讲座：
- en: '**[https://discord.bpbonline.com](https://discord.bpbonline.com)**'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '**[https://discord.bpbonline.com](https://discord.bpbonline.com)**'
- en: '![](images/fm1.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](images/fm1.png)'
