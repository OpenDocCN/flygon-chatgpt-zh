- en: '[CHAPTER 14Creating and Recording Macros in VBA](contents.xhtml#ch14a)'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[Introduction](contents.xhtml#sc2_185a)'
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we explore the world of VBA macros and their role in automating
    repetitive tasks in Microsoft Excel. VBA, which stands for Visual Basic for Applications,
    is a powerful programming language embedded within Excel. Macros, which are sequences
    of commands, allow us to automate actions and streamline our workflow. Whether
    you’re new to VBA or have some experience, this chapter provides a comprehensive
    guide to creating and recording macros. You’ll learn the fundamentals of VBA,
    the benefits of macros, and how to create macros through writing code or recording
    actions. Get ready to boost your productivity and efficiency in Excel with the
    power of VBA macros.
  prefs: []
  type: TYPE_NORMAL
- en: '[Structure](contents.xhtml#sc2_186a)'
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will go over the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Introduction to VBA
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction to Macros
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating a Macro
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Recording a Macro
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Defining a Macro
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Stop Recording
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Relative Reference Macro
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Running Your Macro
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Running the Macro by name
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Objectives](contents.xhtml#sc2_187a)'
  prefs: []
  type: TYPE_NORMAL
- en: By the end of this chapter, are to introduce VBA and macros, explain the process
    of creating and recording macros, define macros and their properties, demonstrate
    how to run macros, and provide practical examples for creating macros to automate
    tasks in Excel.
  prefs: []
  type: TYPE_NORMAL
- en: '[Introduction to VBA](contents.xhtml#sc2_188a)'
  prefs: []
  type: TYPE_NORMAL
- en: VBA stands for Visual Basic for Applications. It is a programming language that
    is included with all of the Microsoft Office applications, such as Excel, Word,
    PowerPoint, and so on. It is also the language that Excel macros are written in.
    VBA is a subset of Microsoft Visual Basic.
  prefs: []
  type: TYPE_NORMAL
- en: '[Uses of VBA](contents.xhtml#sc3_189a)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Some of the uses of VBA are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: To drive an entire application.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: To combine multiple actions in one action, that is, macro.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: To write your own functions.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Introduction to Macros](contents.xhtml#sc2_190a)'
  prefs: []
  type: TYPE_NORMAL
- en: A Macro is a series of commands written in logical order, in order to automate
    any repeated task. It is stored in Microsoft Visual Basic Module. It can be assigned
    to the Add-ins tab or a button on the Quick Access Toolbar.
  prefs: []
  type: TYPE_NORMAL
- en: 'Some examples where Macros are made are:'
  prefs: []
  type: TYPE_NORMAL
- en: To automatically add a standard company header to any spreadsheet at the press
    of a button.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: To format a text file from a general ledger system into a more usable format.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: To print out certain sheets from within a workbook, rather than going through
    each sheet and printing individually.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Creating a Macro](contents.xhtml#sc2_191a)'
  prefs: []
  type: TYPE_NORMAL
- en: 'There are two methods to create macros:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Writing: Write code for the actions in the sequence using VBA language for
    the macros.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Recording: Record your actions in Excel using Macro Recorder. Excel has a Macro
    Recorder which records the action and writes the code for the macro.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The best approach when it comes to creating a macro, is by following the given
    steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Identify the exact problem and the end result that the user wants from the macro.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Plan the steps of your macro to get the end result successfully.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create your macro either by recording, writing or combining both.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Note: Record the action which you have in Excel otherwise write it.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Adding Developer tab on ribbon](contents.xhtml#sc3_192a)'
  prefs: []
  type: TYPE_NORMAL
- en: 'To add a developer tab on Ribbon, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Click on the File Button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on Options… button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'On the Customize Ribbon Tab, select Show Developer Tab in the Ribbon, as shown
    in [Figure 14.1](#fig14-1):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](images/Figure_14.1.png)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: 'Figure 14.1: Adding Developer tab on ribbon'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[Recording a Macro](contents.xhtml#sc2_193a)'
  prefs: []
  type: TYPE_NORMAL
- en: 'To record a macro, follow the given steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Click on the Developer Tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In group Code, click on Record Macro button, as shown in [Figure 14.2](#fig14-2):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](images/Figure_14.2.png)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: 'Figure 14.2: Recording a Macro'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[Defining a Macro](contents.xhtml#sc2_194a)'
  prefs: []
  type: TYPE_NORMAL
- en: 'To define a macro, follow the given steps:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](images/Figure_14.3.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 14.3: Defining a Macro'
  prefs: []
  type: TYPE_NORMAL
- en: 'When it comes to assigning names to Macros, follow the given rules:'
  prefs: []
  type: TYPE_NORMAL
- en: Macro name can consist of alphabets and numbers.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It should not start with digits.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It should not have any special symbol except underscore(_).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It can have a maximum 255 characters.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Do not use a macro name that is also a cell reference.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Macro storage](contents.xhtml#sc3_195a)'
  prefs: []
  type: TYPE_NORMAL
- en: The different macro storage are as follows;
  prefs: []
  type: TYPE_NORMAL
- en: 'Personal Macro Workbook: Recording will be performed on current workbook whereas
    macro will be stored in a file named Personal.xls. This a hidden file (located
    inside XLSTART folder) which gets opened whenever the Excel application is open.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'This Workbook: Recording will be performed on current workbook and macro will
    be stored in current file.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'New Workbook: Recording will be performed on current workbook whereas macro
    will be stored in new file.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Note: Macros can be used if the file in which they are stored is open. If you
    want a macro to be available whenever you use Excel, select the Personal Macro
    Workbook option.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Macro shortcut](contents.xhtml#sc3_196a)'
  prefs: []
  type: TYPE_NORMAL
- en: 'You can use Ctrl+ Letter (for lowercase letters) or Ctrl + Shift+ letter (for
    uppercase letters), where letter is any letter key on the keyboard. The shortcut
    key letter you use cannot be a number or special character such as @ or #. The
    shortcut key will override any equivalent default Microsoft Excel shortcut keys,
    while the workbook that contains the macro is open.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Macro description](contents.xhtml#sc3_197a)'
  prefs: []
  type: TYPE_NORMAL
- en: The description is used to write details about the macro, such as what the aim
    of this macro is, and so on. This helps in post maintenance.
  prefs: []
  type: TYPE_NORMAL
- en: '[Stop recording](contents.xhtml#sc2_198a)'
  prefs: []
  type: TYPE_NORMAL
- en: 'To stop recording a macro, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Perform the actions required to be executed by a macro.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Stop recording by either clicking on the Stop Recording button on Developer
    tab in Group Code or on the status bar at bottom.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Refer to the following [Figure 14.4](#fig14-4):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](images/Figure_14.4.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 14.4: Stop recording a macro'
  prefs: []
  type: TYPE_NORMAL
- en: '[Relative Reference Macro](contents.xhtml#sc2_199a)'
  prefs: []
  type: TYPE_NORMAL
- en: If you want the macro to run relative to the position of the active cell, record
    it using relative cell references. On the Developer tab, click on Use Relative
    Reference so that it is selected. Excel will continue to record macros with relative
    references until you quit Excel or until you click Use Relative Reference again,
    so that it is not selected.
  prefs: []
  type: TYPE_NORMAL
- en: 'Refer to [Figure 14.5](#fig14-5):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](images/Figure_14.5.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 14.5: Stop recording a macro'
  prefs: []
  type: TYPE_NORMAL
- en: 'Note: Use Relative reference button is a toggle button. Be careful about it,
    and before you start recording, check whether it is selected or not.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Scenario 1](contents.xhtml#sc3_200a)'
  prefs: []
  type: TYPE_NORMAL
- en: Create a macro to automatically add the company’s name with the specific format
    in the first row to any spreadsheet.
  prefs: []
  type: TYPE_NORMAL
- en: 'For this, refer to Training File1.xls and follow the given steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Start recording.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Give the name Company_name.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Give shortcut as Ctrl + Shift + C.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Carry out the following steps:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the first cell (since name should come on first row).
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Type your company’s name.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Apply the format: font size 20, bold , blue font , white background.'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Select A1 to H1 cells.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on Merge tool.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Stop the recording:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to the Tools menu, then Macro | Stop Recording.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Refer to the following [Figure 14.6](#fig14-6):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](images/Figure_14.6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 14.6: Scenario 1'
  prefs: []
  type: TYPE_NORMAL
- en: '[Running your macro](contents.xhtml#sc2_201a)'
  prefs: []
  type: TYPE_NORMAL
- en: Macros can be run by
  prefs: []
  type: TYPE_NORMAL
- en: The shortcut (which you assign while defining macro)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The name
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Button on Quick Access Toolbar
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The button on worksheet
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Running the Macro by name](contents.xhtml#sc2_202a)'
  prefs: []
  type: TYPE_NORMAL
- en: 'To run your macro by name, follow the given steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Go to the Developer tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select Macros, (Snapshot 1)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the macro which you want to run, (Snapshot 2)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the Run button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Refer to the following [Figure 14.7](#fig14-7):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](images/Figure_14.7.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 14.7: Running a macro by name'
  prefs: []
  type: TYPE_NORMAL
- en: '[Scenario 2](contents.xhtml#sc3_203a)'
  prefs: []
  type: TYPE_NORMAL
- en: Create a macro to display a product table with the table headers, Product Name,
    Quantity, Price, Total and Net. The table must always appear from the second row
    and first column. Excel should not accept any negative values for price and quantity.
    This macro will always result from second row first column (A1 reference).
  prefs: []
  type: TYPE_NORMAL
- en: 'Steps to be performed as follows (Refer Training File1.xls):'
  prefs: []
  type: TYPE_NORMAL
- en: Start recording (give name Product_Table and short cut Ctrl + Shift + P)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the cell A2 (table must always appear from the second row and first column).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Create a table as per [Figure 14.8](#fig14-8):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Write the formula for total and Net Total.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Format it.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Do validation for quantity and price cells (negative values are restricted).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Stop the recording.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Refer to the following [Figure 14.8](#fig14-8):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](images/Figure_14.8.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 14.8: Scenario 2'
  prefs: []
  type: TYPE_NORMAL
- en: '[Scenario 3](contents.xhtml#sc3_204a)'
  prefs: []
  type: TYPE_NORMAL
- en: Create a macro to display the same product table (Scenario 2), but this time
    it should appear anywhere, wherever user wants (Using relative reference). This
    macro depends on user’s selection.
  prefs: []
  type: TYPE_NORMAL
- en: 'The steps to be performed as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Start recording (give name Product_Table_Relative and short cut).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Switch on Relative Reference button on the Stop Recording toolbar.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a table from the current cell as per [Figure 14.9](#fig14-9).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Note: Start typing from where ever you are in the sheet; do not unnecessarily
    click in the sheet while creating a relative reference macro.'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Write the formula for total and Net Total.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Format it.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Do validation for quantity and price cells (negative values are restricted).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Switch off the Relative Reference button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Stop the recording.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Refer to the following [Figure 14.9](#fig14-9):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](images/Figure_14.9.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 14.9: Scenario 3'
  prefs: []
  type: TYPE_NORMAL
- en: '[Conclusion](contents.xhtml#sc2_205a)'
  prefs: []
  type: TYPE_NORMAL
- en: To summarize, this chapter has introduced the fundamentals of VBA macros and
    their significance in automating tasks in Excel. By creating and recording macros,
    users can streamline repetitive actions and enhance productivity. Whether through
    manual coding or the recording feature, macros offer a powerful tool for customizing
    and optimizing Excel functionality. By leveraging macros, users can save time,
    reduce errors, and improve efficiency.
  prefs: []
  type: TYPE_NORMAL
- en: '[Exercise](contents.xhtml#sc2_206a)'
  prefs: []
  type: TYPE_NORMAL
- en: Create a macro named “CalculateAverage” that calculates the average of a range
    of numbers in Excel.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a macro named “FormatData” that applies specific formatting to a range
    of cells in Excel.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a macro named “GenerateReport” that automates the process of generating
    a report in Excel.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Join our book’s Discord space
  prefs: []
  type: TYPE_NORMAL
- en: 'Join the book’s Discord Workspace for Latest updates, Offers, Tech happenings
    around the world, New Release and Sessions with the Authors:'
  prefs: []
  type: TYPE_NORMAL
- en: '**[https://discord.bpbonline.com](https://discord.bpbonline.com)**'
  prefs: []
  type: TYPE_NORMAL
- en: '![](images/fm1.png)'
  prefs: []
  type: TYPE_IMG
